{"version":3,"sources":["../src/types/enums.ts","../src/utils/permissions.ts","../src/utils/roles.ts","../src/utils/validators.ts","../src/constants/permissions.ts","../src/constants/roles.ts","../src/constants/organization.ts"],"names":["UserStatus","OrganizationTier","SystemRoleName","OrganizationPermission"],"mappings":"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","file":"index.mjs","sourcesContent":["/**\n * User status enum\n */\nexport enum UserStatus {\n  ACTIVE = 'active',\n  INACTIVE = 'inactive',\n  SUSPENDED = 'suspended',\n  LOCKED = 'locked',\n  PENDING_VERIFICATION = 'pending_verification',\n}\n\n/**\n * Organization tier/plan enum\n */\nexport enum OrganizationTier {\n  FREE = 'FREE',\n  PREMIUM = 'PREMIUM',\n}\n\n/**\n * System role names for organization members\n */\nexport enum SystemRoleName {\n  OWNER = 'owner',\n  ADMIN = 'admin',\n  MEMBER = 'member',\n  VIEWER = 'viewer',\n}\n\n/**\n * Granular permissions for organizations\n * These can be extended per application needs\n */\nexport enum OrganizationPermission {\n  // Organization management\n  ORG_READ = 'organization.read',\n  ORG_UPDATE = 'organization.update',\n  ORG_DELETE = 'organization.delete',\n  ORG_SETTINGS = 'organization.settings',\n\n  // Member management\n  MEMBERS_READ = 'organization.members.read',\n  MEMBERS_INVITE = 'organization.members.invite',\n  MEMBERS_MANAGE = 'organization.members.manage',\n  MEMBERS_REMOVE = 'organization.members.remove',\n\n  // Role management\n  ROLES_READ = 'organization.roles.read',\n  ROLES_CREATE = 'organization.roles.create',\n  ROLES_UPDATE = 'organization.roles.update',\n  ROLES_DELETE = 'organization.roles.delete',\n\n  // Content management (generic, can be adapted)\n  CONTENT_CREATE = 'organization.content.create',\n  CONTENT_READ = 'organization.content.read',\n  CONTENT_UPDATE = 'organization.content.update',\n  CONTENT_DELETE = 'organization.content.delete',\n  CONTENT_PUBLISH = 'organization.content.publish',\n\n  // Client management (if applicable)\n  CLIENTS_READ = 'organization.clients.read',\n  CLIENTS_CREATE = 'organization.clients.create',\n  CLIENTS_UPDATE = 'organization.clients.update',\n  CLIENTS_DELETE = 'organization.clients.delete',\n  CLIENTS_MANAGE_PORTAL = 'organization.clients.manage_portal',\n\n  // Billing\n  BILLING_READ = 'organization.billing.read',\n  BILLING_MANAGE = 'organization.billing.manage',\n}\n","import { OrganizationPermission } from '../types/enums';\n\n/**\n * Check if user has a specific permission\n * Pure function - no dependencies, easily testable\n *\n * @param userPermissions - List of user's permissions (can include wildcard '*')\n * @param required - The required permission to check\n * @returns True if user has the permission\n */\nexport function hasPermission(\n  userPermissions: (OrganizationPermission | '*')[],\n  required: OrganizationPermission,\n): boolean {\n  return userPermissions.includes('*') || userPermissions.includes(required);\n}\n\n/**\n * Check if user has any of the given permissions\n *\n * @param userPermissions - List of user's permissions\n * @param required - List of required permissions (user needs at least one)\n * @returns True if user has at least one of the required permissions\n */\nexport function hasAnyPermission(\n  userPermissions: (OrganizationPermission | '*')[],\n  required: OrganizationPermission[],\n): boolean {\n  if (userPermissions.includes('*')) {\n    return true;\n  }\n  return required.some((permission) => userPermissions.includes(permission));\n}\n\n/**\n * Check if user has all of the given permissions\n *\n * @param userPermissions - List of user's permissions\n * @param required - List of required permissions (user needs all of them)\n * @returns True if user has all of the required permissions\n */\nexport function hasAllPermissions(\n  userPermissions: (OrganizationPermission | '*')[],\n  required: OrganizationPermission[],\n): boolean {\n  if (userPermissions.includes('*')) {\n    return true;\n  }\n  return required.every((permission) => userPermissions.includes(permission));\n}\n\n/**\n * Get missing permissions from a list of required permissions\n *\n * @param userPermissions - List of user's permissions\n * @param required - List of required permissions\n * @returns Array of missing permissions (empty if user has all)\n */\nexport function getMissingPermissions(\n  userPermissions: (OrganizationPermission | '*')[],\n  required: OrganizationPermission[],\n): OrganizationPermission[] {\n  if (userPermissions.includes('*')) {\n    return [];\n  }\n  return required.filter((permission) => !userPermissions.includes(permission));\n}\n\n/**\n * Merge multiple permission sets (union)\n *\n * @param permissionSets - Multiple arrays of permissions to merge\n * @returns Unique permissions from all sets\n */\nexport function mergePermissions(\n  ...permissionSets: (OrganizationPermission | '*')[][]\n): (OrganizationPermission | '*')[] {\n  // If any set has wildcard, return wildcard\n  const hasWildcard = permissionSets.some((set) => set.includes('*'));\n  if (hasWildcard) {\n    return ['*'];\n  }\n\n  // Otherwise merge and deduplicate\n  const merged = permissionSets.flat();\n  return Array.from(new Set(merged));\n}\n\n/**\n * Check if permission set includes wildcard (all permissions)\n *\n * @param permissions - List of permissions\n * @returns True if includes wildcard\n */\nexport function hasWildcardPermission(permissions: (OrganizationPermission | '*')[]): boolean {\n  return permissions.includes('*');\n}\n","import { SystemRoleName } from '../types/enums';\n\n/**\n * Get the hierarchy level of a role\n * Higher number = more privileged\n *\n * @param role - System role name\n * @returns Hierarchy level (1-4, or 0 for unknown)\n */\nexport function getRoleHierarchyLevel(role: SystemRoleName): number {\n  const hierarchy: Record<SystemRoleName, number> = {\n    [SystemRoleName.OWNER]: 4,\n    [SystemRoleName.ADMIN]: 3,\n    [SystemRoleName.MEMBER]: 2,\n    [SystemRoleName.VIEWER]: 1,\n  };\n  return hierarchy[role] ?? 0;\n}\n\n/**\n * Check if roleA is higher in hierarchy than roleB\n *\n * @param roleA - First role\n * @param roleB - Second role\n * @returns True if roleA is higher than roleB\n */\nexport function isHigherRole(roleA: SystemRoleName, roleB: SystemRoleName): boolean {\n  return getRoleHierarchyLevel(roleA) > getRoleHierarchyLevel(roleB);\n}\n\n/**\n * Check if roleA is higher or equal to roleB in hierarchy\n *\n * @param roleA - First role\n * @param roleB - Second role\n * @returns True if roleA is higher or equal to roleB\n */\nexport function isHigherOrEqualRole(roleA: SystemRoleName, roleB: SystemRoleName): boolean {\n  return getRoleHierarchyLevel(roleA) >= getRoleHierarchyLevel(roleB);\n}\n\n/**\n * Check if user has a specific role\n *\n * @param userRoles - List of user's roles\n * @param required - Required role\n * @returns True if user has the role\n */\nexport function hasRole(userRoles: SystemRoleName[], required: SystemRoleName): boolean {\n  return userRoles.includes(required);\n}\n\n/**\n * Check if user has any of the given roles\n *\n * @param userRoles - List of user's roles\n * @param required - List of required roles (user needs at least one)\n * @returns True if user has at least one of the required roles\n */\nexport function hasAnyRole(userRoles: SystemRoleName[], required: SystemRoleName[]): boolean {\n  return required.some((role) => userRoles.includes(role));\n}\n\n/**\n * Check if user has all of the given roles\n *\n * @param userRoles - List of user's roles\n * @param required - List of required roles (user needs all of them)\n * @returns True if user has all of the required roles\n */\nexport function hasAllRoles(userRoles: SystemRoleName[], required: SystemRoleName[]): boolean {\n  return required.every((role) => userRoles.includes(role));\n}\n\n/**\n * Get the highest role from a list of roles\n *\n * @param roles - List of roles\n * @returns The highest role in the list, or null if empty\n */\nexport function getHighestRole(roles: SystemRoleName[]): SystemRoleName | null {\n  if (roles.length === 0) return null;\n\n  return roles.reduce((highest, current) => {\n    return isHigherRole(current, highest) ? current : highest;\n  }, roles[0]);\n}\n\n/**\n * Check if user is owner\n *\n * @param userRoles - List of user's roles\n * @returns True if user has owner role\n */\nexport function isOwner(userRoles: SystemRoleName[]): boolean {\n  return hasRole(userRoles, SystemRoleName.OWNER);\n}\n\n/**\n * Check if user is admin or owner\n *\n * @param userRoles - List of user's roles\n * @returns True if user has admin or owner role\n */\nexport function isAdminOrOwner(userRoles: SystemRoleName[]): boolean {\n  return hasAnyRole(userRoles, [SystemRoleName.OWNER, SystemRoleName.ADMIN]);\n}\n\n/**\n * Sort roles by hierarchy (highest first)\n *\n * @param roles - List of roles to sort\n * @returns Sorted roles (highest to lowest)\n */\nexport function sortRolesByHierarchy(roles: SystemRoleName[]): SystemRoleName[] {\n  return [...roles].sort((a, b) => getRoleHierarchyLevel(b) - getRoleHierarchyLevel(a));\n}\n","/**\n * Validation utilities for tenant/organization data\n */\n\n/**\n * Validate organization slug format\n * Slug should be lowercase, alphanumeric with hyphens, 3-50 characters\n *\n * @param slug - Organization slug to validate\n * @returns True if valid\n */\nexport function validateOrganizationSlug(slug: string): boolean {\n  if (!slug || typeof slug !== 'string') return false;\n\n  // Regex: lowercase alphanumeric, hyphens allowed, 3-50 chars\n  const slugRegex = /^[a-z0-9]([a-z0-9-]{1,48}[a-z0-9])?$/;\n  return slugRegex.test(slug);\n}\n\n/**\n * Validate organization name\n * Name should be 1-100 characters\n *\n * @param name - Organization name to validate\n * @returns True if valid\n */\nexport function validateOrganizationName(name: string): boolean {\n  if (!name || typeof name !== 'string') return false;\n\n  const trimmed = name.trim();\n  return trimmed.length >= 1 && trimmed.length <= 100;\n}\n\n/**\n * Validate role name format\n * Role name should be lowercase, alphanumeric with underscores, 1-50 characters\n *\n * @param roleName - Role name to validate\n * @returns True if valid\n */\nexport function validateRoleName(roleName: string): boolean {\n  if (!roleName || typeof roleName !== 'string') return false;\n\n  // Regex: lowercase alphanumeric, underscores allowed, 1-50 chars\n  const roleRegex = /^[a-z0-9_]{1,50}$/;\n  return roleRegex.test(roleName);\n}\n\n/**\n * Validate email format\n * Basic email validation\n *\n * @param email - Email to validate\n * @returns True if valid\n */\nexport function validateEmail(email: string): boolean {\n  if (!email || typeof email !== 'string') return false;\n\n  // Basic email regex\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n}\n\n/**\n * Normalize organization slug\n * Convert to lowercase, replace spaces with hyphens, remove invalid chars\n *\n * @param input - Input string\n * @returns Normalized slug\n */\nexport function normalizeOrganizationSlug(input: string): string {\n  if (!input || typeof input !== 'string') return '';\n\n  return input\n    .toLowerCase()\n    .trim()\n    .replace(/\\s+/g, '-') // Replace spaces with hyphens\n    .replace(/[^a-z0-9-]/g, '') // Remove invalid characters\n    .replace(/-+/g, '-') // Replace multiple hyphens with single\n    .replace(/^-|-$/g, ''); // Remove leading/trailing hyphens\n}\n\n/**\n * Check if slug is reserved\n * Prevent using common reserved words as organization slugs\n *\n * @param slug - Slug to check\n * @returns True if reserved\n */\nexport function isReservedSlug(slug: string): boolean {\n  const reserved = [\n    'admin',\n    'api',\n    'app',\n    'auth',\n    'billing',\n    'dashboard',\n    'docs',\n    'help',\n    'home',\n    'login',\n    'logout',\n    'new',\n    'null',\n    'pricing',\n    'register',\n    'settings',\n    'signup',\n    'support',\n    'terms',\n    'undefined',\n    'www',\n  ];\n\n  return reserved.includes(slug.toLowerCase());\n}\n","import { OrganizationPermission, SystemRoleName } from '../types/enums';\n\n/**\n * Default permissions for each system role\n */\nexport const DEFAULT_PERMISSIONS_BY_ROLE: Record<\n  SystemRoleName,\n  (OrganizationPermission | '*')[]\n> = {\n  [SystemRoleName.OWNER]: ['*'], // Owner has all permissions\n\n  [SystemRoleName.ADMIN]: [\n    // Organization\n    OrganizationPermission.ORG_READ,\n    OrganizationPermission.ORG_UPDATE,\n    OrganizationPermission.ORG_SETTINGS,\n\n    // Members\n    OrganizationPermission.MEMBERS_READ,\n    OrganizationPermission.MEMBERS_INVITE,\n    OrganizationPermission.MEMBERS_MANAGE,\n    OrganizationPermission.MEMBERS_REMOVE,\n\n    // Roles\n    OrganizationPermission.ROLES_READ,\n    OrganizationPermission.ROLES_CREATE,\n    OrganizationPermission.ROLES_UPDATE,\n    OrganizationPermission.ROLES_DELETE,\n\n    // Content\n    OrganizationPermission.CONTENT_CREATE,\n    OrganizationPermission.CONTENT_READ,\n    OrganizationPermission.CONTENT_UPDATE,\n    OrganizationPermission.CONTENT_DELETE,\n    OrganizationPermission.CONTENT_PUBLISH,\n\n    // Clients\n    OrganizationPermission.CLIENTS_READ,\n    OrganizationPermission.CLIENTS_CREATE,\n    OrganizationPermission.CLIENTS_UPDATE,\n    OrganizationPermission.CLIENTS_DELETE,\n    OrganizationPermission.CLIENTS_MANAGE_PORTAL,\n\n    // Billing\n    OrganizationPermission.BILLING_READ,\n    OrganizationPermission.BILLING_MANAGE,\n  ],\n\n  [SystemRoleName.MEMBER]: [\n    // Organization\n    OrganizationPermission.ORG_READ,\n\n    // Members\n    OrganizationPermission.MEMBERS_READ,\n\n    // Roles\n    OrganizationPermission.ROLES_READ,\n\n    // Content\n    OrganizationPermission.CONTENT_CREATE,\n    OrganizationPermission.CONTENT_READ,\n    OrganizationPermission.CONTENT_UPDATE,\n\n    // Clients\n    OrganizationPermission.CLIENTS_READ,\n    OrganizationPermission.CLIENTS_CREATE,\n    OrganizationPermission.CLIENTS_UPDATE,\n\n    // Billing\n    OrganizationPermission.BILLING_READ,\n  ],\n\n  [SystemRoleName.VIEWER]: [\n    // Organization\n    OrganizationPermission.ORG_READ,\n\n    // Members\n    OrganizationPermission.MEMBERS_READ,\n\n    // Content\n    OrganizationPermission.CONTENT_READ,\n\n    // Clients\n    OrganizationPermission.CLIENTS_READ,\n  ],\n};\n\n/**\n * Get default permissions for a role\n *\n * @param role - System role name\n * @returns Array of default permissions for the role\n */\nexport function getDefaultPermissionsForRole(\n  role: SystemRoleName,\n): (OrganizationPermission | '*')[] {\n  return DEFAULT_PERMISSIONS_BY_ROLE[role] ?? [];\n}\n","import { type RoleHierarchy } from '../types/interfaces.js';\nimport { SystemRoleName } from '../types/enums.js';\nimport { DEFAULT_PERMISSIONS_BY_ROLE } from './permissions.js';\n\n/**\n * Role hierarchy configuration\n * Defines the hierarchy level and default permissions for each system role\n */\nexport const ROLE_HIERARCHY: Record<SystemRoleName, RoleHierarchy> = {\n  [SystemRoleName.OWNER]: {\n    role: SystemRoleName.OWNER,\n    level: 4,\n    defaultPermissions: DEFAULT_PERMISSIONS_BY_ROLE[SystemRoleName.OWNER],\n  },\n  [SystemRoleName.ADMIN]: {\n    role: SystemRoleName.ADMIN,\n    level: 3,\n    defaultPermissions: DEFAULT_PERMISSIONS_BY_ROLE[SystemRoleName.ADMIN],\n  },\n  [SystemRoleName.MEMBER]: {\n    role: SystemRoleName.MEMBER,\n    level: 2,\n    defaultPermissions: DEFAULT_PERMISSIONS_BY_ROLE[SystemRoleName.MEMBER],\n  },\n  [SystemRoleName.VIEWER]: {\n    role: SystemRoleName.VIEWER,\n    level: 1,\n    defaultPermissions: DEFAULT_PERMISSIONS_BY_ROLE[SystemRoleName.VIEWER],\n  },\n};\n\n/**\n * Get role hierarchy information\n *\n * @param role - System role name\n * @returns Role hierarchy information\n */\nexport function getRoleHierarchyInfo(role: SystemRoleName): RoleHierarchy | null {\n  return ROLE_HIERARCHY[role] ?? null;\n}\n\n/**\n * All system roles ordered by hierarchy (highest to lowest)\n */\nexport const SYSTEM_ROLES_ORDERED: SystemRoleName[] = [\n  SystemRoleName.OWNER,\n  SystemRoleName.ADMIN,\n  SystemRoleName.MEMBER,\n  SystemRoleName.VIEWER,\n];\n","import { OrganizationTier } from '../types/enums';\n\n/**\n * Maximum number of members per organization tier\n */\nexport const MAX_MEMBERS_BY_TIER: Record<OrganizationTier, number> = {\n  [OrganizationTier.FREE]: 5,\n  [OrganizationTier.PREMIUM]: Infinity,\n};\n\n/**\n * Default organization settings\n */\nexport const DEFAULT_ORGANIZATION_SETTINGS = {\n  allowMemberInvite: true,\n  features: [],\n  maxMembers: MAX_MEMBERS_BY_TIER[OrganizationTier.FREE],\n};\n\n/**\n * Organization slug constraints\n */\nexport const ORGANIZATION_SLUG_CONSTRAINTS = {\n  MIN_LENGTH: 3,\n  MAX_LENGTH: 50,\n  PATTERN: /^[a-z0-9]([a-z0-9-]{1,48}[a-z0-9])?$/,\n};\n\n/**\n * Organization name constraints\n */\nexport const ORGANIZATION_NAME_CONSTRAINTS = {\n  MIN_LENGTH: 1,\n  MAX_LENGTH: 100,\n};\n\n/**\n * Get max members for a tier\n *\n * @param tier - Organization tier\n * @returns Maximum number of members allowed\n */\nexport function getMaxMembersForTier(tier: OrganizationTier): number {\n  return MAX_MEMBERS_BY_TIER[tier] ?? MAX_MEMBERS_BY_TIER[OrganizationTier.FREE];\n}\n"]}